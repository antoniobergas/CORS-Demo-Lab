<!DOCTYPE html>
<html>
<head>
    <title>iframeWeb Login Website with Parameter</title>
</head>
<body>


    <!-- -------------------------------------------------------------------------------------------- -->
    <!-- -------------------------------------------------------------------------------------------- -->
    <!--                       Setup login form to store passwords in local storage                                                   -->
    <!-- -------------------------------------------------------------------------------------------- -->
    <!-- -------------------------------------------------------------------------------------------- -->
    <form onsubmit="return accessWebsite()">
        <input type="text" name="cid" id="cid"/>
        <input type="password" name="pwd" id="pwd" />
        <input type="submit" value="Login" />
    </form>

    <p id="response"></p>


    <script>
        function accessWebsite() {
            myu = document.getElementById('cid').value;
            myp = document.getElementById('pwd').value;
            param='username: '+ myu + ' pass: ' + myp            
            localStorage.setItem("userpass", param);
            sessionStorage.setItem("iframeName", param);
        }
     </script>
    <!-- -------------------------------------------------------------------------------------------- -->
    <!-- -------------------------------------------------------------------------------------------- -->
    <!--            Setup Button to send message to parent via postMessage -->
    <!-- -------------------------------------------------------------------------------------------- -->
    <!-- -------------------------------------------------------------------------------------------- -->


    <button type="button" id="button1" >Send Message to Parent<button>
    <p id="response"></p>
        <script>

            function clickHandler () {
                console.log("iframeWeb Posting Message");
                window.parent.postMessage('Iframe sending to parent: ',
                '*');//could be generic too like '*'
                }
    // ----------------------------------------------------------------------------
    // ----------------------------------------------------------------------------
    //        Setup message listener, to alert when receive message iframes or parent
    // ----------------------------------------------------------------------------
    // ----------------------------------------------------------------------------    
        
        document.getElementById("button1").addEventListener('click',clickHandler,false);
        let count = 1
        // ------------  Receive Message
        var messageEventHandler = function(event){
           // check that the origin is one we want.
            //if(event.origin == 'https://www.tutorialspoint.com') {
            if(true) {                
                //alert(event.data);
                console.log('Iframe host '+ window.location.host + ' responding with:  '+ event.data);
                document.getElementById("response").innerHTML = event.data  + count;
                count += 1
            }            
            }           
        window.addEventListener('message', messageEventHandler,false);


    </script>
</body>
</html>
